---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const posts = await getCollection("blog", ({ data }) => !data.draft);
posts.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());

const categoryIcons: Record<string, string> = {
  Growth: "üìà",
  Comparison: "‚öñÔ∏è",
  Monetization: "üí∞",
  Ads: "üì£",
  Retention: "üîÑ",
  "Getting Started": "üöÄ",
  General: "üìù",
};
---

<BaseLayout
  title="Skool Growth Blog: Strategies and Case Studies | SKOOL.HELP"
  description="Guides, strategies, and insights for Skool.com community owners."
  canonicalUrl="https://skool.help/blog"
>
  <div class="max-w-[1200px] mx-auto px-6 py-12 md:py-16">
    <div class="mb-10">
      <h1 class="text-3xl md:text-4xl font-bold tracking-tight mb-2">Blog</h1>
      <p class="text-muted-foreground">
        Practical guides and growth strategies for Skool community owners.
      </p>
    </div>

    <div class="divide-y divide-border">
      {
        posts.map((post) => (
          <a href={`/blog/${post.id}`} class="blog-row group">
            <img
              src={post.data.heroImage}
              alt={post.data.title}
              class="blog-thumb"
              loading="lazy"
            />

            <div class="blog-content">
              <span class="blog-category">
                {categoryIcons[post.data.category] || "üìù"} {post.data.category}
              </span>
              <h2
                class="blog-title"
                style="font-size: 26px; line-height: 1.3; font-weight: 600; margin: 0 0 6px 0;"
              >
                {post.data.title}
              </h2>
              <p
                class="blog-excerpt"
                style="font-size: 16px; line-height: 1.5; margin: 0;"
              >
                {post.data.description}
              </p>
            </div>

            <div class="blog-meta">
              <div class="blog-author">
                <img
                  src={post.data.author.avatar}
                  alt={post.data.author.name}
                  class="blog-avatar"
                  loading="lazy"
                />
                <span>{post.data.author.name}</span>
              </div>
            </div>
          </a>
        ))
      }
    </div>
  </div>
</BaseLayout>

<style is:global>
  .blog-row {
    display: grid;
    grid-template-columns: 250px 1fr auto;
    gap: 20px;
    align-items: center;
    padding: 20px 0;
    transition: opacity 0.15s;
  }
  .blog-row:hover {
    opacity: 0.8;
  }
  .blog-thumb {
    width: 250px;
    height: 165px;
    object-fit: cover;
    border-radius: 8px;
    flex-shrink: 0;
  }
  .blog-content {
    min-width: 0;
  }
  .blog-category {
    font-size: 11px;
    color: hsl(var(--muted-foreground));
    display: block;
    margin-bottom: 4px;
  }
  .blog-title {
    color: hsl(var(--foreground) / 0.9);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .blog-row:hover .blog-title {
    color: hsl(var(--foreground));
  }
  .blog-excerpt {
    color: hsl(var(--muted-foreground));
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .blog-meta {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 4px;
    flex-shrink: 0;
  }
  .blog-author {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: hsl(var(--foreground) / 0.8);
  }
  .blog-avatar {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    object-fit: cover;
  }
  @media (max-width: 768px) {
    .blog-row {
      grid-template-columns: 1fr;
      gap: 10px;
    }
    .blog-meta {
      display: none;
    }
    .blog-thumb {
      width: 100%;
      height: 180px;
    }
    .blog-title {
      font-size: 18px !important;
    }
  }

  @media (max-width: 480px) {
    .blog-excerpt {
      display: none;
    }
  }
</style>
